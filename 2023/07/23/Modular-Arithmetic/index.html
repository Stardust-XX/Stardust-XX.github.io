<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Modular Arithmetic | Stardust‘s Blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - $1 行","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>Modular Arithmetic</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2023-07-23T08:52:50.000Z" id="date"> 2023-07-23</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-09-10T04:30:24.153Z" id="updated"> 2023-09-10</time></div></span><br><span>文章总字数: <div class="control">3.4k</div></span></div></div><hr><div id="post-content"><p><a target="_blank" rel="noopener" href="https://cryptohack.org/">CryptoHack</a>教程的第二章：模运算。看来这一章整章都是围着数学转了。</p>
<p>数学公式好像要刷新一下网页才能看到，不知道怎么回事（</p>
<span id="more"></span>
<h1 id="Greatest-Common-Divisor"><a href="#Greatest-Common-Divisor" class="headerlink" title="Greatest Common Divisor"></a>Greatest Common Divisor</h1><blockquote>
<p>The Greatest Common Divisor (GCD), sometimes known as the highest common factor, is the largest number which divides two positive integers (a,b).</p>
<p>For <code>a = 12, b = 8</code> we can calculate the divisors of a: <code>{1,2,3,4,6,12}</code> and the divisors of b: <code>{1,2,4,8}</code>. Comparing these two, we see that <code>gcd(a,b) = 4</code>.</p>
<p>Now imagine we take <code>a = 11, b = 17</code>. Both <code>a</code> and <code>b</code> are prime numbers. As a prime number has only itself and <code>1</code> as divisors, <code>gcd(a,b) = 1</code>.</p>
<p>We say that for any two integers <code>a,b</code>, if <code>gcd(a,b) = 1</code> then <code>a</code> and <code>b</code> are coprime integers.</p>
<p>If <code>a</code> and <code>b</code> are prime, they are also coprime. If <code>a</code> is prime and <code>b &lt; a</code> then <code>a</code> and <code>b</code> are coprime.</p>
<p>There are many tools to calculate the GCD of two integers, but for this task we recommend looking up <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Euclidean_algorithm">Euclid’s Algorithm</a>.</p>
<p>Try coding it up; it’s only a couple of lines. Use <code>a = 12, b = 8</code> to test it.</p>
<p>Now calculate <code>gcd(a,b)</code> for <code>a = 66528, b = 52920</code> and enter it below.</p>
</blockquote>
<p>第一节GCD，我们熟知的最大公因数。具体就不再赘述了，我们可以用欧几里得算法手算或者写代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">gcd</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> b &gt; a:<br>        <span class="hljs-keyword">return</span> gcd(b, a)<br>    <span class="hljs-keyword">if</span> a % b == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> b<br>    <span class="hljs-keyword">return</span> gcd(b, a % b)<br></code></pre></td></tr></table></figure>
<p>计算<code>print(gcd(66528,52920))</code>即可得到答案1512.</p>
<h1 id="Extended-GCD"><a href="#Extended-GCD" class="headerlink" title="Extended GCD"></a>Extended GCD</h1><blockquote>
<p>Let <code>a</code> and <code>b</code> be positive integers.</p>
<p>The extended Euclidean algorithm is an efficient way to find integers <code>u,v</code> such that</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">a * u + b * v = gcd(a,b)<br></code></pre></td></tr></table></figure>
<p>Using the two primes <code>p = 26513, q = 32321</code>, find the integers <code>u,v</code> such that</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">p * u + q * v = gcd(p,q)<br></code></pre></td></tr></table></figure>
<p>Enter whichever of <code>u</code> and <code>v</code> is the lower number as the flag.</p>
</blockquote>
<p>第二节讲的是扩展的欧几里得算法。</p>
<p>不管是手算还是写代码都有点麻烦，<del>我的建议是直接用<code>gmpy2</code>库里的<code>gcdext()</code>来计算。</del></p>
<p>这里放一个别的大佬写的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):<br>    x, y, u, v = <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> a != <span class="hljs-number">0</span>:<br>        q, r = b//a, b % a<br>        m, n = x-u*q, y-v*q<br>        b, a, x, y, u, v = a, r, u, v, m, n<br>    gcd = b<br>    <span class="hljs-keyword">return</span> gcd, x, y<br><span class="hljs-built_in">print</span>(egcd(<span class="hljs-number">26513</span>,<span class="hljs-number">32321</span>))<br></code></pre></td></tr></table></figure>
<p>结果是10245和-8404，输入-8404即可通过。</p>
<h1 id="Modular-Arithmetic-1"><a href="#Modular-Arithmetic-1" class="headerlink" title="Modular Arithmetic 1"></a>Modular Arithmetic 1</h1><blockquote>
<p>Imagine you lean over and look at a cryptographer’s notebook. You see some notes in the margin:</p>
<blockquote>
<p>4 + 9 = 1<br>5 - 7 = 10<br>2 + 3 = 5</p>
</blockquote>
<p>At first you might think they’ve gone mad. Maybe this is why there are so many data leaks nowadays you’d think, but this is nothing more than modular arithmetic modulo 12 (albeit with some sloppy notation).</p>
<p>You may not have been calling it modular arithmetic, but you’ve been doing these kinds of calculations since you learnt to tell the time (look again at those equations and think about adding hours).</p>
<p>Formally, “calculating time” is described by the theory of congruences. We say that two integers are congruent modulo m if <code>a ≡ b mod m</code>.</p>
<p>Another way of saying this, is that when we divide the integer <code>a</code> by <code>m</code>, the remainder is <code>b</code>. This tells you that if m divides a (this can be written as <code>m | a</code>) then <code>a ≡ 0 mod m</code>.</p>
<p>Calculate the following integers:</p>
<blockquote>
<p>11 ≡ x mod 6<br>8146798528947 ≡ y mod 17</p>
</blockquote>
<p>The solution is the smaller of the two integers.</p>
</blockquote>
<p>这一节开始引入了模运算的概念，很容易得到<code>x=5,y=4</code></p>
<p>答案是4.</p>
<h1 id="Modular-Arithmetic-2"><a href="#Modular-Arithmetic-2" class="headerlink" title="Modular Arithmetic 2"></a>Modular Arithmetic 2</h1><blockquote>
<p>We’ll pick up from the last challenge and imagine we’ve picked a modulus <code>p</code>, and we will restrict ourselves to the case when <code>p</code> is prime.</p>
<p>The integers modulo <code>p</code> define a field, denoted <code>Fp</code>.</p>
<blockquote>
<p>If the modulus is not prime, the set of integers modulo <code>n</code> define a ring.</p>
</blockquote>
<p>A finite field <code>Fp</code> is the set of integers <code>{0,1,...,p-1}</code>, and under both addition and multiplication there is an inverse element <code>b</code> for every element <code>a</code> in the set, such that <code>a + b = 0</code> and <code>a * b = 1</code>.</p>
<blockquote>
<p>Note that the identity element for addition and multiplication is different! This is because the identity when acted with the operator should do nothing: <code>a + 0 = a</code> and <code>a * 1 = a</code>.</p>
</blockquote>
<p>Lets say we pick <code>p = 17</code>. Calculate 3^17^ mod 17. Now do the same but with 5^17^ mod 17.</p>
<p>What would you expect to get for 7^16^ mod 17? Try calculating that.</p>
<p>This interesting fact is known as Fermat’s little theorem. We’ll be needing this (and its generalisations) when we look at RSA cryptography.</p>
<p>Now take the prime <code>p = 65537</code>. Calculate 273246787654^65536^ mod 65537.</p>
<p>Did you need a calculator?</p>
</blockquote>
<p>这里讲了很多，实际上就是介绍了费马小定理：</p>
<p>如果<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>是素数，并且<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></svg></mjx-container>不是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container>的倍数，则</p>
<script type="math/tex; mode=display">
a^{p-1}\equiv1 \mod{p}</script><p>所以答案很显然就是1.</p>
<h1 id="Modular-Inverting"><a href="#Modular-Inverting" class="headerlink" title="Modular Inverting"></a>Modular Inverting</h1><blockquote>
<p>As we’ve seen, we can work within a finite field <code>Fp</code>, adding and multiplying elements, and always obtain another element of the field.</p>
<p>For all elements <code>g</code> in the field, there exists a unique integer <code>d</code> such that <code>g * d ≡ 1 mod p</code>.</p>
<p>This is the multiplicative inverse of <code>g</code>.</p>
<p><strong>Example</strong>: <code>7 * 8 = 56 ≡ 1 mod 11</code></p>
<p>What is the inverse element: <code>3 * d ≡ 1 mod 13</code>?</p>
<blockquote>
<p>Think about the little theorem we just worked with. How does this help you find the inverse of an element?</p>
</blockquote>
</blockquote>
<p>这一节讲的是逆元，题目中提示我们用上一节中的定理计算。</p>
<script type="math/tex; mode=display">
\begin{align}
3^{12}&\equiv1 \mod{13}\\
3*d&\equiv1 \mod{13}
\end{align}</script><p>所以</p>
<script type="math/tex; mode=display">
\begin{align}
3*d&\equiv3^{12}\mod{13}\\
d&\equiv3^{11}\mod{13}
\end{align}</script><p>3^11^模13与9同余，答案为9.</p>
<h1 id="Quadratic-Residues"><a href="#Quadratic-Residues" class="headerlink" title="Quadratic Residues"></a>Quadratic Residues</h1><blockquote>
<p>We’ve looked at multiplication and division in modular arithmetic, but what does it mean to take the square root modulo an integer?</p>
<p>For the following discussion, let’s work modulo <code>p = 29</code>. We can take the integer <code>a = 11</code> and calculate <code>a2 = 5 mod 29</code>.</p>
<p>As <code>a = 11, a2 = 5</code>, we say the square root of <code>5</code> is <code>11</code>.</p>
<p>This feels good, but now let’s think about the square root of <code>18</code>. From the above, we know we need to find some integer <code>a</code> such that <code>a2 = 18</code></p>
<p>Your first idea might be to start with <code>a = 1</code> and loop to <code>a = p-1</code>. In this discussion <code>p</code> isn’t too large and we can quickly look.</p>
<p>Have a go, try coding this and see what you find. If you’ve coded it right, you’ll find that for all <code>a ∈ Fp*</code> you never find an <code>a</code> such that <code>a2 = 18</code>.</p>
<p>What we are seeing, is that for the elements of <code>F*p</code>, not every element has a square root. In fact, what we find is that for roughly one half of the elements of <code>Fp*</code>, there is no square root.</p>
<p>We say that an integer <code>x</code> is a <em>Quadratic Residue</em> if there exists an <code>a</code> such that <code>a2 = x mod p</code>. If there is no such solution, then the integer is a <em>Quadratic Non-Residue</em>.</p>
<p>In other words, <code>x</code> is a quadratic residue when it is possible to take the square root of <code>x</code> modulo an integer <code>p</code>.</p>
<p>In the below list there are two non-quadratic residues and one quadratic residue.</p>
<p>Find the quadratic residue and then calculate its square root. Of the two possible roots, submit the smaller one as the flag.</p>
<p>If <code>a2 = x</code> then (-a)2 = x. So if <code>x</code> is a quadratic residue in some finite field, then there are always two solutions for <code>a</code>.</p>
</blockquote>
<p>这一节讲的是二次剩余与二次非剩余。</p>
<p>这里用程序遍历每个数依次计算即可，算得6是模29的二次剩余，6模29最小的根为8.</p>
<h1 id="Legendre-Symbol"><a href="#Legendre-Symbol" class="headerlink" title="Legendre Symbol"></a>Legendre Symbol</h1><blockquote>
<p>In Quadratic Residues we learnt what it means to take the square root modulo an integer. We also saw that taking a root isn’t always possible.</p>
<p>In the previous case when <code>p = 29</code>, even the simplest method of calculating the square root was fast enough, but as <code>p</code> gets larger, this method becomes wildly unreasonable.</p>
<p>Lucky for us, we have a way to check whether an integer is a quadratic residue with a single calculation thanks to Legendre. In the following, we will assume we are working modulo a prime <code>p</code>.</p>
<p>Before looking at Legendre’s symbol, let’s take a brief detour to see an interesting property of quadratic (non-)residues.</p>
<blockquote>
<p>Quadratic Residue <em> Quadratic Residue = Quadratic Residue<br>Quadratic Residue </em> Quadratic Non-residue = Quadratic Non-residue<br>Quadratic Non-residue * Quadratic Non-residue = Quadratic Residue</p>
</blockquote>
<p>So what’s the trick? The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Legendre_symbol">Legendre Symbol</a> gives an efficient way to determine whether an integer is a quadratic residue modulo an odd prime <code>p</code>.</p>
<p>Legendre’s Symbol: <code>(a / p) ≡ a(p-1)/2 mod p</code> obeys:</p>
<blockquote>
<p>(a / p) = 1 if a is a quadratic residue and a ≢ 0 mod p<br>(a / p) = -1 if a is a quadratic non-residue mod p<br>(a / p) = 0 if a ≡ 0 mod p</p>
</blockquote>
<p>Which means given any integer <code>a</code>, calculating <code>pow(a,(p-1)//2,p)</code> is enough to determine if <code>a</code> is a quadratic residue.</p>
<p>Now for the flag. Given the following 1024 bit prime and 10 integers, find the quadratic residue and then calculate its square root; the square root is your flag. Of the two possible roots, submit the larger one as your answer.</p>
<p><strong>Challenge files:</strong></p>
<p> - <a target="_blank" rel="noopener" href="https://cryptohack.org/static/challenges/output_479698cde19aaa05d9e9dfca460f5443.txt">output.txt</a></p>
</blockquote>
<p>这一节讲了勒让德符号判断一个数是否为模p二次剩余，在<code>gmpy2</code>库中就有一个<code>legendre()</code>可以直接使用。</p>
<p>先计算一下哪个是平方剩余</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> legendre<br>ints = [<span class="hljs-number">25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803</span>, <span class="hljs-number">45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555</span>, <span class="hljs-number">17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325</span>, <span class="hljs-number">14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863</span>, <span class="hljs-number">4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318</span>, <span class="hljs-number">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span>, <span class="hljs-number">50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987</span>, <span class="hljs-number">96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871</span>, <span class="hljs-number">4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721</span>, <span class="hljs-number">18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565</span>]<br>p = <span class="hljs-number">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br>    <span class="hljs-built_in">print</span>(legendre(ints[i],p))<br></code></pre></td></tr></table></figure>
<p>ints[5]为1，其余都为-1，所以只有ints[5]为平方剩余。</p>
<h2 id="费马小定理推导求解"><a href="#费马小定理推导求解" class="headerlink" title="费马小定理推导求解"></a>费马小定理推导求解</h2><p>在提示中提到可以用费马小定理解</p>
<script type="math/tex; mode=display">
\begin{align}
a^{p-1}&\equiv1\ \ \mod{p}\\
a^{p+1}&\equiv a^{2}\mod{p}\\
a^{\frac{p+1}{2}}&\equiv a\ \ \mod{p}
\end{align}</script><p>那么很显然，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g></g></g></svg></mjx-container>的平方根即<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="16.845ex" height="2.777ex" role="img" focusable="false" viewBox="0 -1033.4 7445.5 1227.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mfrac"><g data-mml-node="mrow" transform="translate(220,477.2) scale(0.707)"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(503,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mn" transform="translate(1281,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="mn" transform="translate(672.9,-345) scale(0.707)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g><rect width="1459.4" height="60" x="120" y="220"></rect></g></g></g><g data-mml-node="mo" transform="translate(2091.4,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z"></path></g><g data-mml-node="mi" transform="translate(3147.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mspace" transform="translate(3719.2,0)"></g><g data-mml-node="mi" transform="translate(4552.8,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)"></path></g><g data-mml-node="mstyle" transform="translate(6441.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mstyle" transform="translate(6608.8,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6942.5,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g></g></g></svg></mjx-container></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> powmod<br>p = <span class="hljs-number">101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139</span><br>a = <span class="hljs-number">85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771</span><br><span class="hljs-built_in">print</span>(powmod(a,(p+<span class="hljs-number">1</span>)//<span class="hljs-number">4</span>,p))<br></code></pre></td></tr></table></figure>
<p>得到答案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">93291799125366706806545638475797430512104976066103610269938025709952247020061090804870186195285998727680200979853848718589126765742550855954805290253592144209552123062161458584575060939481368210688629862036958857604707468372384278049741369153506182660264876115428251983455344219194133033177700490981696141526<br></code></pre></td></tr></table></figure>
<h2 id="SageMath列方程求解"><a href="#SageMath列方程求解" class="headerlink" title="SageMath列方程求解"></a>SageMath列方程求解</h2><p>也可以用SageMath解决。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SageMath">p=101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139<br>a=85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771<br>PR.&lt;x&gt;=PolynomialRing(Zmod(p))<br>f=x^2-a<br>f.roots()<br></code></pre></td></tr></table></figure>
<p>用SageMath求解它的根，得到两个数，最大的即为答案，与上一个方法相同。</p>
<h1 id="Modular-Square-Root"><a href="#Modular-Square-Root" class="headerlink" title="Modular Square Root"></a>Modular Square Root</h1><blockquote>
<p>In Legendre Symbol we introduced a fast way to determine whether a number is a square root modulo a prime. We can go further: there are algorithms for efficiently calculating such roots. The best one in practice is called Tonelli-Shanks, which gets its funny name from the fact that it was first described by an Italian in the 19th century and rediscovered independently by Daniel Shanks in the 1970s.</p>
<p>All primes that aren’t 2 are of the form <code>p ≡ 1 mod 4</code> or <code>p ≡ 3 mod 4</code>, since all odd numbers obey these congruences. As the previous challenge hinted, in the <code>p ≡ 3 mod 4</code> case, a really simple formula for computing square roots can be <a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/a/20994">derived</a> directly from Fermat’s little theorem. That leaves us still with the <code>p ≡ 1 mod 4</code> case, so a more general algorithm is required.</p>
<p>In a congruence of the form <code>r2 ≡ a mod p</code>, Tonelli-Shanks calculates <code>r</code>.</p>
<blockquote>
<p>Tonelli-Shanks doesn’t work for composite (non-prime) moduli. Finding square roots modulo composites is computationally equivalent to integer factorization - that is, it’s a hard problem.</p>
</blockquote>
<p>The main use-case for this algorithm is finding elliptic curve co-ordinates. Its operation is somewhat complex so we’re not going to discuss the details, however, implementations are easy to find and Sage has one built-in.</p>
<p>Find the square root of <code>a</code> modulo the 2048-bit prime <code>p</code>. Give the smaller of the two roots as your answer.</p>
<p><strong>Challenge files:</strong><br> - <a target="_blank" rel="noopener" href="https://cryptohack.org/static/challenges/output_abe0beb359a950c8a0a9300897528a9d.txt">output.txt</a></p>
</blockquote>
<p>这一节讲了求模p平方根的方法，叫Tonelli-Shanks<del>但实际上我根本没明白他到底在讲些什么</del></p>
<p>实际上计算还是很简单的，Python中有很多库都支持计算模p平方根（比如<code>sympy</code>中的<code>sqrt_mod</code>）。</p>
<p>这里继续用上一题中的SageMath计算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs SageMath">a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768<br>p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161<br>PR.&lt;x&gt;=PolynomialRing(Zmod(p))<br>f=x^2-a<br>f.roots()<br></code></pre></td></tr></table></figure>
<p>得到答案为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120<br></code></pre></td></tr></table></figure>
<h1 id="Chinese-Remainder-Theorem"><a href="#Chinese-Remainder-Theorem" class="headerlink" title="Chinese Remainder Theorem"></a>Chinese Remainder Theorem</h1><blockquote>
<p>The Chinese Remainder Theorem gives a unique solution to a set of linear congruences if their moduli are coprime.</p>
<p>This means, that given a set of arbitrary integers <code>ai</code>, and pairwise coprime integers <code>ni</code>, such that the following linear congruences hold:</p>
<p> Note “pairwise coprime integers” means that if we have a set of integers <code>{n1, n2, ..., ni}</code>, all pairs of integers selected from the set are coprime: <code>gcd(ni, nj) = 1</code>.</p>
<blockquote>
<p>x ≡ a1 mod n1<br>x ≡ a2 mod n2<br>…<br>x ≡ an mod nn</p>
</blockquote>
<p>There is a unique solution <code>x ≡ a mod N</code> where <code>N = n1 * n2 * ... * nn</code>.</p>
<p>In cryptography, we commonly use the Chinese Remainder Theorem to help us reduce a problem of very large integers into a set of several, easier problems.</p>
<p>Given the following set of linear congruences:</p>
<blockquote>
<p>x ≡ 2 mod 5<br>x ≡ 3 mod 11<br>x ≡ 5 mod 17</p>
</blockquote>
<p>Find the integer <code>a</code> such that <code>x ≡ a mod 935</code></p>
<p> Starting with the congruence with the largest modulus, use that for <code>x ≡ a mod p</code> we can write <code>x = a + k*p</code> for arbitrary integer <code>k</code>.</p>
</blockquote>
<p>这节课介绍的是求一元一次同余方程组的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86">中国剩余定理</a>。</p>
<p>我们可以用遍历找到答案，或是用数学公式求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> invert<br>a1,m1=<span class="hljs-number">2</span>,<span class="hljs-number">5</span><br>a2,m2=<span class="hljs-number">3</span>,<span class="hljs-number">11</span><br>a3,m3=<span class="hljs-number">5</span>,<span class="hljs-number">17</span><br>M1=m2*m3<br>M2=m1*m3<br>M3=m1*m2<br><span class="hljs-built_in">print</span>((a1*M1*invert(M1,m1)+a2*M2*invert(M2,m2)+a3*M3*invert(M3,m3))%<span class="hljs-number">935</span>)<br></code></pre></td></tr></table></figure>
<p>答案为872。</p>
<h1 id="Adrien’s-Signs"><a href="#Adrien’s-Signs" class="headerlink" title="Adrien’s Signs"></a>Adrien’s Signs</h1><blockquote>
<p>Adrien’s been looking at ways to encrypt his messages with the help of symbols and minus signs. Can you find a way to recover the flag?</p>
<p><strong>Challenge files:</strong><br> - <a target="_blank" rel="noopener" href="https://cryptohack.org/static/challenges/source_734d7e14251f950935f83d228f8694ab.py">source.py</a><br> - <a target="_blank" rel="noopener" href="https://cryptohack.org/static/challenges/output_80fc6398d2fd9f272186d0af510323f9.txt">output.txt</a></p>
</blockquote>
<p>非常简单粗暴，给了一个源码和output让我们解答。</p>
<p>那就让我们先来看看源码，大致意思是把flag中每个字符转换为8位二进制数组成二进制字符串，然后判断字符串中的字符，如果是1则将n直接添加到ciphertext中，如果是0则将-n模p的余数添加到ciphertext中。</p>
<p>e是大于1小于p的随机正整数，n是a^e^模p的余数。</p>
<p>计算一下勒让德符号<code>legendre(a,p)</code>结果为1，所以a是模p的二次剩余。由二次剩余的性质可知n也是模p的二次剩余，-n则是模p的二次非剩余。</p>
<p>所以plaintext中每个1对应ciphertext中一个模p二次剩余数，反之同理。</p>
<p>得到plaintext后每隔8位转为byte字符就是flag了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> legendre<br>p = <span class="hljs-number">1007621497415251</span><br>ciphertext=[<span class="hljs-number">67594220461269</span>, <span class="hljs-number">501237540280788</span>, <span class="hljs-number">718316769824518</span>, <span class="hljs-number">296304224247167</span>, <span class="hljs-number">48290626940198</span>, <span class="hljs-number">30829701196032</span>, <span class="hljs-number">521453693392074</span>, <span class="hljs-number">840985324383794</span>, <span class="hljs-number">770420008897119</span>, <span class="hljs-number">745131486581197</span>, <span class="hljs-number">729163531979577</span>, <span class="hljs-number">334563813238599</span>, <span class="hljs-number">289746215495432</span>, <span class="hljs-number">538664937794468</span>, <span class="hljs-number">894085795317163</span>, <span class="hljs-number">983410189487558</span>, <span class="hljs-number">863330928724430</span>, <span class="hljs-number">996272871140947</span>, <span class="hljs-number">352175210511707</span>, <span class="hljs-number">306237700811584</span>, <span class="hljs-number">631393408838583</span>, <span class="hljs-number">589243747914057</span>, <span class="hljs-number">538776819034934</span>, <span class="hljs-number">365364592128161</span>, <span class="hljs-number">454970171810424</span>, <span class="hljs-number">986711310037393</span>, <span class="hljs-number">657756453404881</span>, <span class="hljs-number">388329936724352</span>, <span class="hljs-number">90991447679370</span>, <span class="hljs-number">714742162831112</span>, <span class="hljs-number">62293519842555</span>, <span class="hljs-number">653941126489711</span>, <span class="hljs-number">448552658212336</span>, <span class="hljs-number">970169071154259</span>, <span class="hljs-number">339472870407614</span>, <span class="hljs-number">406225588145372</span>, <span class="hljs-number">205721593331090</span>, <span class="hljs-number">926225022409823</span>, <span class="hljs-number">904451547059845</span>, <span class="hljs-number">789074084078342</span>, <span class="hljs-number">886420071481685</span>, <span class="hljs-number">796827329208633</span>, <span class="hljs-number">433047156347276</span>, <span class="hljs-number">21271315846750</span>, <span class="hljs-number">719248860593631</span>, <span class="hljs-number">534059295222748</span>, <span class="hljs-number">879864647580512</span>, <span class="hljs-number">918055794962142</span>, <span class="hljs-number">635545050939893</span>, <span class="hljs-number">319549343320339</span>, <span class="hljs-number">93008646178282</span>, <span class="hljs-number">926080110625306</span>, <span class="hljs-number">385476640825005</span>, <span class="hljs-number">483740420173050</span>, <span class="hljs-number">866208659796189</span>, <span class="hljs-number">883359067574584</span>, <span class="hljs-number">913405110264883</span>, <span class="hljs-number">898864873510337</span>, <span class="hljs-number">208598541987988</span>, <span class="hljs-number">23412800024088</span>, <span class="hljs-number">911541450703474</span>, <span class="hljs-number">57446699305445</span>, <span class="hljs-number">513296484586451</span>, <span class="hljs-number">180356843554043</span>, <span class="hljs-number">756391301483653</span>, <span class="hljs-number">823695939808936</span>, <span class="hljs-number">452898981558365</span>, <span class="hljs-number">383286682802447</span>, <span class="hljs-number">381394258915860</span>, <span class="hljs-number">385482809649632</span>, <span class="hljs-number">357950424436020</span>, <span class="hljs-number">212891024562585</span>, <span class="hljs-number">906036654538589</span>, <span class="hljs-number">706766032862393</span>, <span class="hljs-number">500658491083279</span>, <span class="hljs-number">134746243085697</span>, <span class="hljs-number">240386541491998</span>, <span class="hljs-number">850341345692155</span>, <span class="hljs-number">826490944132718</span>, <span class="hljs-number">329513332018620</span>, <span class="hljs-number">41046816597282</span>, <span class="hljs-number">396581286424992</span>, <span class="hljs-number">488863267297267</span>, <span class="hljs-number">92023040998362</span>, <span class="hljs-number">529684488438507</span>, <span class="hljs-number">925328511390026</span>, <span class="hljs-number">524897846090435</span>, <span class="hljs-number">413156582909097</span>, <span class="hljs-number">840524616502482</span>, <span class="hljs-number">325719016994120</span>, <span class="hljs-number">402494835113608</span>, <span class="hljs-number">145033960690364</span>, <span class="hljs-number">43932113323388</span>, <span class="hljs-number">683561775499473</span>, <span class="hljs-number">434510534220939</span>, <span class="hljs-number">92584300328516</span>, <span class="hljs-number">763767269974656</span>, <span class="hljs-number">289837041593468</span>, <span class="hljs-number">11468527450938</span>, <span class="hljs-number">628247946152943</span>, <span class="hljs-number">8844724571683</span>, <span class="hljs-number">813851806959975</span>, <span class="hljs-number">72001988637120</span>, <span class="hljs-number">875394575395153</span>, <span class="hljs-number">70667866716476</span>, <span class="hljs-number">75304931994100</span>, <span class="hljs-number">226809172374264</span>, <span class="hljs-number">767059176444181</span>, <span class="hljs-number">45462007920789</span>, <span class="hljs-number">472607315695803</span>, <span class="hljs-number">325973946551448</span>, <span class="hljs-number">64200767729194</span>, <span class="hljs-number">534886246409921</span>, <span class="hljs-number">950408390792175</span>, <span class="hljs-number">492288777130394</span>, <span class="hljs-number">226746605380806</span>, <span class="hljs-number">944479111810431</span>, <span class="hljs-number">776057001143579</span>, <span class="hljs-number">658971626589122</span>, <span class="hljs-number">231918349590349</span>, <span class="hljs-number">699710172246548</span>, <span class="hljs-number">122457405264610</span>, <span class="hljs-number">643115611310737</span>, <span class="hljs-number">999072890586878</span>, <span class="hljs-number">203230862786955</span>, <span class="hljs-number">348112034218733</span>, <span class="hljs-number">240143417330886</span>, <span class="hljs-number">927148962961842</span>, <span class="hljs-number">661569511006072</span>, <span class="hljs-number">190334725550806</span>, <span class="hljs-number">763365444730995</span>, <span class="hljs-number">516228913786395</span>, <span class="hljs-number">846501182194443</span>, <span class="hljs-number">741210200995504</span>, <span class="hljs-number">511935604454925</span>, <span class="hljs-number">687689993302203</span>, <span class="hljs-number">631038090127480</span>, <span class="hljs-number">961606522916414</span>, <span class="hljs-number">138550017953034</span>, <span class="hljs-number">932105540686829</span>, <span class="hljs-number">215285284639233</span>, <span class="hljs-number">772628158955819</span>, <span class="hljs-number">496858298527292</span>, <span class="hljs-number">730971468815108</span>, <span class="hljs-number">896733219370353</span>, <span class="hljs-number">967083685727881</span>, <span class="hljs-number">607660822695530</span>, <span class="hljs-number">650953466617730</span>, <span class="hljs-number">133773994258132</span>, <span class="hljs-number">623283311953090</span>, <span class="hljs-number">436380836970128</span>, <span class="hljs-number">237114930094468</span>, <span class="hljs-number">115451711811481</span>, <span class="hljs-number">674593269112948</span>, <span class="hljs-number">140400921371770</span>, <span class="hljs-number">659335660634071</span>, <span class="hljs-number">536749311958781</span>, <span class="hljs-number">854645598266824</span>, <span class="hljs-number">303305169095255</span>, <span class="hljs-number">91430489108219</span>, <span class="hljs-number">573739385205188</span>, <span class="hljs-number">400604977158702</span>, <span class="hljs-number">728593782212529</span>, <span class="hljs-number">807432219147040</span>, <span class="hljs-number">893541884126828</span>, <span class="hljs-number">183964371201281</span>, <span class="hljs-number">422680633277230</span>, <span class="hljs-number">218817645778789</span>, <span class="hljs-number">313025293025224</span>, <span class="hljs-number">657253930848472</span>, <span class="hljs-number">747562211812373</span>, <span class="hljs-number">83456701182914</span>, <span class="hljs-number">470417289614736</span>, <span class="hljs-number">641146659305859</span>, <span class="hljs-number">468130225316006</span>, <span class="hljs-number">46960547227850</span>, <span class="hljs-number">875638267674897</span>, <span class="hljs-number">662661765336441</span>, <span class="hljs-number">186533085001285</span>, <span class="hljs-number">743250648436106</span>, <span class="hljs-number">451414956181714</span>, <span class="hljs-number">527954145201673</span>, <span class="hljs-number">922589993405001</span>, <span class="hljs-number">242119479617901</span>, <span class="hljs-number">865476357142231</span>, <span class="hljs-number">988987578447349</span>, <span class="hljs-number">430198555146088</span>, <span class="hljs-number">477890180119931</span>, <span class="hljs-number">844464003254807</span>, <span class="hljs-number">503374203275928</span>, <span class="hljs-number">775374254241792</span>, <span class="hljs-number">346653210679737</span>, <span class="hljs-number">789242808338116</span>, <span class="hljs-number">48503976498612</span>, <span class="hljs-number">604300186163323</span>, <span class="hljs-number">475930096252359</span>, <span class="hljs-number">860836853339514</span>, <span class="hljs-number">994513691290102</span>, <span class="hljs-number">591343659366796</span>, <span class="hljs-number">944852018048514</span>, <span class="hljs-number">82396968629164</span>, <span class="hljs-number">152776642436549</span>, <span class="hljs-number">916070996204621</span>, <span class="hljs-number">305574094667054</span>, <span class="hljs-number">981194179562189</span>, <span class="hljs-number">126174175810273</span>, <span class="hljs-number">55636640522694</span>, <span class="hljs-number">44670495393401</span>, <span class="hljs-number">74724541586529</span>, <span class="hljs-number">988608465654705</span>, <span class="hljs-number">870533906709633</span>, <span class="hljs-number">374564052429787</span>, <span class="hljs-number">486493568142979</span>, <span class="hljs-number">469485372072295</span>, <span class="hljs-number">221153171135022</span>, <span class="hljs-number">289713227465073</span>, <span class="hljs-number">952450431038075</span>, <span class="hljs-number">107298466441025</span>, <span class="hljs-number">938262809228861</span>, <span class="hljs-number">253919870663003</span>, <span class="hljs-number">835790485199226</span>, <span class="hljs-number">655456538877798</span>, <span class="hljs-number">595464842927075</span>, <span class="hljs-number">191621819564547</span>]<br>plaintext=<span class="hljs-string">''</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> ciphertext:<br>    <span class="hljs-keyword">if</span> legendre(i,p)==<span class="hljs-number">1</span>:<br>        plaintext+=<span class="hljs-string">'1'</span><br>    <span class="hljs-keyword">else</span>:<br>        plaintext+=<span class="hljs-string">'0'</span><br>flag=<span class="hljs-string">''</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(plaintext),<span class="hljs-number">8</span>):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(plaintext[i: i + <span class="hljs-number">8</span>],<span class="hljs-number">2</span>))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>
<p>答案为<code>crypto{p4tterns_1n_re5idu3s}</code></p>
<h1 id="Modular-Binomials"><a href="#Modular-Binomials" class="headerlink" title="Modular Binomials"></a>Modular Binomials</h1><blockquote>
<p>Rearrange the following equations to get the primes <code>p,q</code></p>
<blockquote>
<p>N = pq<br>c1 = (2p + 3q)^e1 mod N<br>c2 = (5p + 7q)^e2 mod N</p>
</blockquote>
<p><strong>Challenge files:</strong><br> - <a target="_blank" rel="noopener" href="https://cryptohack.org/static/challenges/data_04a0fe134cf31a6c941377aad75db81c.txt">data.txt</a></p>
</blockquote>
<script type="math/tex; mode=display">
\begin{align}
c_{1}&=(2p+3q)^{e_{1}}\mod{N}\\
c_{1}^{e_{2}}&=(2p+3q)^{e_{1}e_{2}}\mod{N}
\end{align}</script><p>将右式展开后，因为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="7.205ex" height="1.984ex" role="img" focusable="false" viewBox="0 -683 3184.6 877"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1165.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2221.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(2724.6,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>，所以所有含<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="2.179ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 963 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(503,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>的项都可以约掉</p>
<script type="math/tex; mode=display">
\begin{align}
c_{1}^{e_{2}}&=(2p)^{e_{1}e_{2}}+(3q)^{e_{1}e_{2}}\mod{N}\\
2^{-e_{1}e_{2}}c_{1}^{e_{2}}&=p^{e_{1}e_{2}}+2^{-e_{1}e_{2}}(3q)^{e_{1}e_{2}}\mod{N}\\
\end{align}</script><p>同理，二式也可以进行化简</p>
<script type="math/tex; mode=display">
5^{-e_{1}e_{2}}c_{2}^{e_{1}}=p^{e_{1}e_{2}}+5^{-e_{1}e_{2}}(7q)^{e_{1}e_{2}}\mod{N}</script><p>两式相减</p>
<script type="math/tex; mode=display">
5^{-e_{1}e_{2}}c_{2}^{e_{1}}-2^{-e_{1}e_{2}}c_{1}^{e_{2}}=5^{-e_{1}e_{2}}(7q)^{e_{1}e_{2}}-2^{-e_{1}e_{2}}(3q)^{e_{1}e_{2}}\mod{N}</script><p>可见右式为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.041ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 460 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>的倍数，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="7.205ex" height="1.984ex" role="img" focusable="false" viewBox="0 -683 3184.6 877"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(1165.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2221.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mi" transform="translate(2724.6,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>，所以<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.041ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 460 636"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg></mjx-container>为左式与<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g></g></g></svg></mjx-container>的最小公倍数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> powmod,gcd<br>N = <span class="hljs-number">14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073</span><br>e1 = <span class="hljs-number">12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span><br>e2 = <span class="hljs-number">12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span><br>c1 = <span class="hljs-number">14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051</span><br>c2 = <span class="hljs-number">14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519</span><br>q = gcd(powmod(<span class="hljs-number">5</span>,(-e2 * e1),N) * powmod(c2, e1, N) - powmod(<span class="hljs-number">2</span>, (-e1 * e2), N) * powmod(c1, e2, N), N)<br>p = N//q<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-built_in">print</span>(q)<br></code></pre></td></tr></table></figure>
<p>得到结果为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">p=112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273<br>q=132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601<br></code></pre></td></tr></table></figure>
<hr>
<p>那么到这里第二章的内容也结束了！这一章全是数学知识，孩子学得很开心，<del>脑子快要烧了。</del></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/07/29/Symmetric-Cryptography/">← 下一篇 Symmetric Cryptography</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/14/Introduction-to-Cryptohack/">Introduction to CryptoHack 上一篇 →</a></div></div></div><div id="comments"><div id="valine"></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="文章目录">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://avatars.githubusercontent.com/u/115343437?s=400&amp;u=112fd8d174229964d26c53fd5884e409225e8b62&amp;v=4" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Stardust-XX">Stardust</a></h1><div id="description"><p></p></div><div id="social-links"><a class="social" target="_blank" rel="noopener" href="https://github.com/Stardust-XX"><i class="fab fa-github" alt="GitHub"></i></a><a class="social" href="mailto:therulerofster@gmail.com"><i class="fa fa-envelope" alt="E-Mail"></i></a><a class="social" target="_blank" rel="noopener" href="https://space.bilibili.com/38597245"><i class="fa-brands fa-bilibili" alt="BiliBili"></i></a></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Greatest-Common-Divisor"><span class="toc-number">1.</span> <span class="toc-text">Greatest Common Divisor</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Extended-GCD"><span class="toc-number">2.</span> <span class="toc-text">Extended GCD</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modular-Arithmetic-1"><span class="toc-number">3.</span> <span class="toc-text">Modular Arithmetic 1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modular-Arithmetic-2"><span class="toc-number">4.</span> <span class="toc-text">Modular Arithmetic 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modular-Inverting"><span class="toc-number">5.</span> <span class="toc-text">Modular Inverting</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Quadratic-Residues"><span class="toc-number">6.</span> <span class="toc-text">Quadratic Residues</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Legendre-Symbol"><span class="toc-number">7.</span> <span class="toc-text">Legendre Symbol</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86%E6%8E%A8%E5%AF%BC%E6%B1%82%E8%A7%A3"><span class="toc-number">7.1.</span> <span class="toc-text">费马小定理推导求解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SageMath%E5%88%97%E6%96%B9%E7%A8%8B%E6%B1%82%E8%A7%A3"><span class="toc-number">7.2.</span> <span class="toc-text">SageMath列方程求解</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modular-Square-Root"><span class="toc-number">8.</span> <span class="toc-text">Modular Square Root</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Chinese-Remainder-Theorem"><span class="toc-number">9.</span> <span class="toc-text">Chinese Remainder Theorem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Adrien%E2%80%99s-Signs"><span class="toc-number">10.</span> <span class="toc-text">Adrien’s Signs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modular-Binomials"><span class="toc-number">11.</span> <span class="toc-text">Modular Binomials</span></a></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {new Valine({
 el: '#valine'
 , appId: 'a2cbBGsWUZQaL1J8U3yUY0pI-gzGzoHsz'
 , appKey: 'ChUAgTkvreWiZC9HtZaBSjcX' , placeholder: '此条评论委托企鹅物流发送'
 , path: window.location.pathname
});document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>